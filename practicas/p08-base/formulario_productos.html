<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Registro de datos "Productos"</title>
    <style type="text/css">
        ol,
        ul {
            list-style-type: none;
        }
    </style>
</head>

<body>
    <h1>Registro de datos</h1>

    <form id="formulario" action="http://localhost:81/proyectos/tecweb/practicas/p08-base/set_producto_v2.php"
        method="post">

        <h2>Información</h2>

        <fieldset>
            <ul>
                <li><label for="form-name">Nombre:</label> <input type="text" name="nombre" id="form-name"></li><br>

                <li><label form="form-marca">Marca:</label>
                    <select name="marca" id="form-marca">
                        <option value="">Selecciona una marca</option>
                        <option value="nike">Nike</option>
                        <option value="adidas">Adidas</option>
                        <option value="reebok">Reebok</option>
                        <option value="salomon">Salomon</option>
                    </select>
                </li><br>

                <li><label for="form-modelo">Modelo:</label> <input type="text" name="modelo" id="form-modelo"></li><br>
                <li><label for="form-precio">Precio:</label> <input type="number" step="0.01" name="precio"
                        id="form-precio"></li><br>
                <li><label for="form-detalles">Detalles:</label><textarea name="detalles" id="form-detalles"></textarea>
                </li><br>
                <li><label for="form-unidades">Unidades:</label> <input type="number" name="unidades"
                        id="form-unidades"></li><br>
                <li><label for="form-imagen">Imagen_url:</label> <input type="text" name="imagen" id="form-imagen"></li>

            </ul>
        </fieldset>

        <p>
            <input type="submit" value="Subir">
            <input type="reset">
        </p>

    </form>
    <script>
        document.getElementById("formulario").addEventListener("submit", function (event) {
            event.preventDefault();

            const DEFAULT_IMAGE = "img/imagen.png";

            const nombre = document.getElementById("form-name").value;
            const marca = document.getElementById("form-marca").value;
            const modelo = document.getElementById("form-modelo").value;
            const precioV = document.getElementById("form-precio").value;
            const precio = parseFloat(precioV);
            const detalles = document.getElementById("form-detalles").value;
            const unidadesV = document.getElementById("form-unidades").value;
            const unidades = parseInt(unidadesV, 10);
            const imagenEl = document.getElementById("form-imagen");
            let imagen = imagenEl.value.trim();

            // a) Nombre
            if (!nombre) { alert("El nombre es requerido."); return; }
            if (nombre.length > 100) { alert("El nombre debe tener 100 caracteres o menos."); return; }

            // b) Marca
            if (!marca) { alert("La marca es requerida."); return; }

            // c) Modelo
            if (!modelo) { alert("El modelo es requerido."); return; }
            if (!/^[A-Za-z0-9]+$/.test(modelo)) { alert("El modelo debe ser alfanumérico."); return; }
            if (modelo.length > 25) { alert("El modelo debe tener 25 caracteres o menos."); return; }

            // d) Precio
            if (precioV === "" || isNaN(precio)) { alert("El precio es requerido."); return; }
            if (precio <= 99.99) { alert("El precio debe ser mayor a 99.99."); return; }

            // e) Detalles (opcional)
            if (detalles.length > 250) { alert("Los detalles no pueden exceder 250 caracteres."); return; }

            // f) Unidades
            if (unidadesV === "" || isNaN(unidades)) { alert("Las unidades son requeridas."); return; }
            if (unidades < 0) { alert("Las unidades deben ser 0 o más."); return; }

            // g) Imagen (opcional con valor por defecto para el envío)
            if (!imagen) {
                imagenEl.value = DEFAULT_IMAGE; // <-- se envía al servidor este valor
            }

            // ¡Ahora sí! Enviar el formulario
            this.submit();
        });
    </script>
</body>

</html>